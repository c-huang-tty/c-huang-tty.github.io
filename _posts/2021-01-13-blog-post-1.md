---
title: 'Statistics [13]: Chi-Squared Test'
date: 2021-01-13
permalink: /posts/2021/01/13/chi-squared-test/
tags:
  - Statistics
---

Basics of <img src="https://render.githubusercontent.com/render/math?math=\chi^2"> test.

## Pearson Chi-Squared Test
Pearson's <img src="https://render.githubusercontent.com/render/math?math=\chi^2"> test is a statistical test applied to sets of categorical data to evaluate how likely it is that any observed difference between the sets arose by chance.

It tests a null hypothesis stating that the frequency distribution of certain events observed in a sample is consistent with a particular theoretical distribution. The events considered must be mutually exclusive and have total probability 1.

To be specific, assume the population follows the following discrete distribution

| <img src="https://render.githubusercontent.com/render/math?math=X"> | <img src="https://render.githubusercontent.com/render/math?math=x_1">  | <img src="https://render.githubusercontent.com/render/math?math=x_2">  | <img src="https://render.githubusercontent.com/render/math?math=\cdots">  | <img src="https://render.githubusercontent.com/render/math?math=x_k">  |
|---|---|---|---|---|
| <img src="https://render.githubusercontent.com/render/math?math=P"> | <img src="https://render.githubusercontent.com/render/math?math=p_1">  | <img src="https://render.githubusercontent.com/render/math?math=p_2">  | <img src="https://render.githubusercontent.com/render/math?math=\cdots">  | <img src="https://render.githubusercontent.com/render/math?math=p_k">  |

Now make <img src="https://render.githubusercontent.com/render/math?math=n"> independent observations, and the frequencies of the <img src="https://render.githubusercontent.com/render/math?math=k"> values are respectively <img src="https://render.githubusercontent.com/render/math?math=N_i (i=1,2,...,k">, then

<img src="https://render.githubusercontent.com/render/math?math=X = {\displaystyle \sum_{i=1}^k\dfrac{(N_i-np_i)^2}{np_i}}">

follows the <img src="https://render.githubusercontent.com/render/math?math=\chi^2"> distribution with <img src="https://render.githubusercontent.com/render/math?math=k-1"> degree of freedom approximately. (This can be proved using the central limit theorem, which can be found [here](https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test#Derivation).)

If there are <img src="https://render.githubusercontent.com/render/math?math=s"> parameters that need to be estimated, then 

<img src="https://render.githubusercontent.com/render/math?math=X = {\displaystyle \sum_{i=1}^k\dfrac{(N_i-np_i)^2}{np_i}}">

follows the <img src="https://render.githubusercontent.com/render/math?math=\chi^2"> distribution with <img src="https://render.githubusercontent.com/render/math?math=k-s-1"> degree of freedom approximately.

### Example 1
In 1910, Rutherford and Geiger observed the number of particles emitted by the radioactive materials. They observed 2608 times in 7.5 s intervals and recorded the number of particles reaching a certain area. Below is the recording, they recorded 10094 particles in total, and <img src="https://render.githubusercontent.com/render/math?math=n_k"> is the times that exactly <img src="https://render.githubusercontent.com/render/math?math=k"> particles are observed. 

| <img src="https://render.githubusercontent.com/render/math?math=k"> |  0 |  1  |  2  |  3  |  4  |  5  |  6  |  7  |  8 |  9 | <img src="https://render.githubusercontent.com/render/math?math=\geq 10"> |
|:-:|:--:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:--:|:--:|:--:|
| <img src="https://render.githubusercontent.com/render/math?math=n_k"> | 57 | 203 | 383 | 525 | 532 | 408 | 273 | 139 | 45 | 27 | 16 |
| <img src="https://render.githubusercontent.com/render/math?math=n\cdot \hat{p}_k"> | 54 | 211 | 407 | 525 | 508 | 394 | 254 | 140 | 68 | 29 | 17 |

Test whether the data follows the Poisson distribution.

__Solution__. Let the number of particles in one observation be the random variable <img src="https://render.githubusercontent.com/render/math?math=X">, as there are 2608 observations, so the probability of one particle falls within one observation is <img src="https://render.githubusercontent.com/render/math?math=\dfrac{1}{2608}">. And as there are 10094 particles recorded, so the distribution of <img src="https://render.githubusercontent.com/render/math?math=X"> is 

<img src="https://render.githubusercontent.com/render/math?math=X \sim B\left(10094, \dfrac{1}{2608}\right)">

On the other hand, according to Poisson theorem, <img src="https://render.githubusercontent.com/render/math?math=X\sim P(\hat{\lambda})">, where <img src="https://render.githubusercontent.com/render/math?math=\hat{\lambda} = \dfrac{10094}{2608} = 3.87">. Hence, 

<img src="https://render.githubusercontent.com/render/math?math=\hat{p}_i = \dfrac{\hat{\lambda}^i}{i!}e^{-\hat{\lambda}} (i=0,1,...,9),\hat{p}_{10} = 1 - \sum_{i=0}^{9}\hat{p}_i">

Therefore, the <img src="https://render.githubusercontent.com/render/math?math=\chi^2"> statistics under the observation would be 

<img src="https://render.githubusercontent.com/render/math?math=Y = {\displaystyle \sum_{i=0}^10\dfrac{(N_i-N\hat{p}_i)}{N\hat{p}_i}}=12.88">

Using the lookup table, 

<img src="https://render.githubusercontent.com/render/math?math=Y\sim \chi^2(9) \Rightarrow  p = P(Y > 12.88) > 0.1">

Therefore, the hypothesis that the data follows the Poisson distribution can be accepted.

