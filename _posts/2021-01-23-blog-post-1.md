---
title: 'Statistics [23]: Monte Carlo'
date: 2021-01-23
permalink: /posts/2021/01/23/monte-carlo/
tags:
  - Statistics
---

Monte Carlo (MC) technique is a numerical method that makes use of random numbers to solve mathematical problems for which an analytical solution is not known.

## A Simple Example: Estimating Pi
Assume we have a circle <img src="https://render.githubusercontent.com/render/math?math=C"> with radius <img src="https://render.githubusercontent.com/render/math?math=r = 0.5"> inscribed within a square <img src="https://render.githubusercontent.com/render/math?math=S">. The area ratio would be 

<img src="https://render.githubusercontent.com/render/math?math=\dfrac{A_{C}}{A_{S}} = \dfrac{\pi r^2}{4r^2} = \dfrac{\pi}{4 }">

To determine <img src="https://render.githubusercontent.com/render/math?math=\pi">, we can randomly select <img src="https://render.githubusercontent.com/render/math?math=n"> points in the square. Suppose <img src="https://render.githubusercontent.com/render/math?math=m"> points fall within the circle, we can then approximate the ratio by

<img src="https://render.githubusercontent.com/render/math?math=\dfrac{A_{C}}{A_{S}}=\dfrac{\pi}{4 }\approx \dfrac{m}{n}">

Hence,

<img src="https://render.githubusercontent.com/render/math?math=\pi = \dfrac{4m}{n}">

Here is the Python code.
```python
import numpy as np
import random
import math
import matplotlib.pyplot as plt

inCircle = 0
outCircle = 0

piValue = []

# number of trials
numTrial = 1

# number of points within each trial
numPoints = 1000

data = np.random.random([numPoints,2])

fig = plt.figure()

for trial in range(numTrial):
    for i in range(numPoints):
        if (data[i][0]-0.5)**2 + (data[i][1]-0.5)**2 <= 1/4:
            plt.plot(data[i][0],data[i][1],'ro')
            inCircle += 1
        else:
            plt.plot(data[i][0],data[i][1],'bo')
            outCircle += 1
        
    piValue.append(4*inCircle/(inCircle + outCircle))

# result
print(sum(piValue)/len(piValue))

# plot
plt.xlim(0, 1)
plt.ylim(0, 1)
ax = fig.add_subplot(1, 1, 1)
plt.gca().set_aspect('equal', adjustable='box')
circ = plt.Circle((0.5, 0.5), 0.5, color='k',fill=False, linewidth=3)
ax.add_patch(circ)
plt.show()
```
<img src="/images/statistics/MC1.png" alt="drawing" width="500"/>


