---
title: 'Statistics [24]: Variance Reducing Techniques'
date: 2021-01-24
permalink: /posts/2021/01/24/variance-reducing-techniques/
tags:
  - Statistics
---

---
## Antithetic Variates
Consider we have an even number of samples, <img src="https://render.githubusercontent.com/render/math?math=2n">, from <img src="https://render.githubusercontent.com/render/math?math=p(x)">. One approach is to generate correlated samples to reduce the variance by cancellations in thier sum. The estimate:

<img src="https://render.githubusercontent.com/render/math?math=I = \dfrac{1}{2n}{\displaystyle \sum_{i=1}^{2n}f(x_i) \dfrac{1}{n}\sum_{i=1}^n g(x_{2i})}">

where

<img src="https://render.githubusercontent.com/render/math?math=g(x_{2i}) = \dfrac{f(x_{2i-1}) %2B f(x_{2i})}{2}">

The variance <img src="https://render.githubusercontent.com/render/math?math=var(g(x_{2i}))">,

<img src="https://render.githubusercontent.com/render/math?math=var(g(x_{2i})) = var\left(\dfrac{f(x_{2i-1}) %2B f(x_{2i})}{2}\right) = \dfrac{1}{4}\left[var(f(x_{2i-1})) %2B var(x_{2i}) %2B 2cov(f(x_{2i-1}),f(x_{2i}))\right]">

Conclusion:
1. When <img src="https://render.githubusercontent.com/render/math?math=cov(f(x_{2i-1}),f(x_{2i}))=0">, the variance remains the same;
2. When <img src="https://render.githubusercontent.com/render/math?math=cov(f(x_{2i-1}),f(x_{2i}))<0">, the variance decreases;
3. WHen <img src="https://render.githubusercontent.com/render/math?math=cov(f(x_{2i-1}),f(x_{2i}))>0">, the variance increases.

### Example 1
Estimate <img src="https://render.githubusercontent.com/render/math?math=\theta=E(e^U) = \int_{0}^1e^xdx">. 

Assume <img src="https://render.githubusercontent.com/render/math?math=U_1"> and <img src="https://render.githubusercontent.com/render/math?math=U_2"> are two samples, let the two samaples be <img src="https://render.githubusercontent.com/render/math?math=U"> and <img src="https://render.githubusercontent.com/render/math?math=1-U">, then

<img src="https://render.githubusercontent.com/render/math?math=cov(e^U,e^{1-U})=E(e^Ue^{1-U}) - E(e^U)E(e^{1-U}) = e - (e-1)^2 = -0.2342">

Hence, 

<img src="https://render.githubusercontent.com/render/math?math=var\left(\dfrac{e^U%2B e^{1-U}}{2}\right) = \dfrac{var(e^U)}{2}%2B \dfrac{cov(e^U,e^{1-U})}{2} = 0.0039">


---
## Control Variates

---
## Stratified Sampling

---
## Importance Sampling
